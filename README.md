# Парсер Excel таблицы для amoCRM
Для начала работы нужно иметь готовый шаблон в amoCRM для того чтобы получать аттрибуты name с input, и готовый excel таблицу. <br>

## Подготовка аддона к работе с сайтом:
Зайти в `data.js` и заменить все имена аттрибутов полей, кроме первых четырех зарезервированных системой полей, также нужно будет установить зарезервированное значение в подходящий номер поля для "раб. номер" и "email" Компании.

Зарезервируемые значения которые вы можете указать `reservedEmail` и `reservedPhone`.

## Как получить аттрибут `name`
Получение аттрибута `name` полей происходит через DevTools при выделении инпута. <br>
Аттрибут поля дожен иметь схожую структуру - `CFV[4567891]`

>Важно заметить, что аттрибут `name` имеющий данную структуру `CFV[4567891][eqNINfec][VALUE]` не валидный и должен быть зарезервирован с помощью значений описанных выше.

После того как заполнили `data.js`, переносим все содержимое в .zip архив и загружаем в amoCRM, таким методом:

```
  Настройки > Установленные интеграции > Создать интеграцию > Заполнить поля, добавить язык > Загрузить архив
```

Аддон появляется только при открытии создания или редактирования сделок, и прикрепляется к форме заполнения.<br>


## Известные проблемы и недостатки
  * Данный аддон не поддерживает добавление двух контактов одновременно;
  * При редактировании не будет меняться имя контакта и название компании.


## Возможное решение проблемы если не парсится таблица .xls
* Внутри `script.js` найти ``workbook = XLSX.read(data, {type: 'binary'});``
* Заменить с `e.target.result` на `data = new Uint8Array(e.target.result);`
* И сменить тип `XLSX.read` на `'array'`
* Изменить тип чтения с `reader.readAsBinaryString` на `reader.readAsArrayBuffer`